
<div class="container">
    <div class="row">
　　　　　　<div class="col-lg-1">

<h1>商品詳細</h1>

<table class="table table-hover">
        <thead>


			  　<tr>
            <td>ジャケ写</td>
            <td>CDシングル</td>
            <td>アーティスト</td>
            <td>タイトル</td>
            <td>レーベル</td>
            <td>ジャンル</td>
            <td>在庫</td>
            <td>ステータス</td>
            <td>価格</td>
          </tr>

      　</thead>

 　             <td><% if  @products.image %>
                <%= attachment_image_tag @products, :image, :fill, 30, 30, format: 'jpeg' %>
              <% end %></td>
                <td><%= @products.single_album_flag %></td>
                <% @products.artists.each do |f| %>
                <td><%= f.name  %></td>
                <% end %>
                <td><%= @products.title %></td>

                <td><%= @products.label.name %></td>
                <% @products.genres.each do |f| %>
                <td><%= f.name  %></td>
                <% end %>
                <td><%= @products.amount %></td>
                <td><%= @products.product_status_id %></td>
                <td><%= @products.price %></td>
                <% if @products.product_status_id.to_i == 0 %>

                  <%= form_with(model: @new_cart_item, url: product_cart_items_path(@products)) do |f| %>
                    <% f.hidden_field :product_id, value: @new_cart_item.product_id %>
                    <%= f.select :product_amount, 1..@products.amount %>
                    <%= f.submit "カートに入れる" %>
                  <% end %>
                  <% end %>

              
</table>

<div id="likes_partial_<%= @products.id %>"><%= render partial: 'public/likes/like',locals: {products: @products} %>
</div>
<div class="first-review">
  <div class="first-review-name">
    <% if @reviews.any? %>
      <%= @reviews.last.user.first_name + @reviews.last.user.last_name %>
  </div>
    <% if @reviews.any? && current_user.id == @reviews.last.user_id %>
      <span><%= link_to '×',product_review_path(@products,@reviews.last.user_id),method: :delete %>
    <%end%>
      </span>
  <div class="first-review-review">
    <%= @reviews.last.review %>
  </div>
</div>
<%end%>
</div>
</div>
<div>
<button class="total-review-button">もっと見る</button>
</div>
<div class="total-review" style="display:none">
<% @reviews.each do |f| %>
<%= f.user.first_name + f.user.last_name %>
<div>
  <%= f.review %>
</div>
<% if f.user_id = current_user.id %>
<%= link_to '×',product_review_path(@products,f.id),method: :delete %>
<%end%>
<% end %>
</div>
<button class="review-button">レビュー投稿</button>
              <div class="review-content" style="display:none">
              	<%= form_for [@products,@review] do |f| %>
				        <%= f.text_area :review %>
				        <%= f.submit '投稿' %>
		            <%end%>
              </div>


<script>
  const reviewButton = document.querySelector('.review-button');
  const reviewContent = document.querySelector('.review-content');
  reviewButton.addEventListener('click',() => {
  reviewContent.style.display = 'block';
  });
// }

// window.onload = function(){
  const totalReview = document.querySelector('.total-review');
  const totalReviewButton = document.querySelector('.total-review-button');
  const firstReview = document.querySelector('.first-review');
  totalReviewButton.addEventListener('click',(event) => {


  totalReviewButton.addEventListener('click',(event) => {

    if (totalReview.style.display === 'none'){
      totalReview.style.display = 'block';
      firstReview.style.display = 'none';
      totalReviewButton.innerHTML = 'しまう';
    }else{
      totalReview.style.display = 'none';
      firstReview.style.display = 'block';
      totalReviewButton.innerHTML = 'もっと見る';
    }
  });
</script>