
<h1>購入確認ページ</h1>

<% if current_user.addresses %>
<%# チェックボックスは最終的にJQueryでどれか一つをチェックすると、先につけたチェックを外すようにする予定です %>
  <p>ご登録済みの住所を使いますか？</p>
  <%= form_tag(new_order_path, method: 'get') do %>
  　<% @addresses.each do |address| %>
      <div class="check_box_tag">
        <%= check_box_tag :to_create_order, address.id %>
        <%= address.delivery_name %><br>
        <%= address.delivery_postal_code %><br>
        <%= address.delivery_address %><br>
      </div>
    <% end %>

    <%= submit_tag "この住所を使う" %>
  <% end %>
<% end %>
<table>
  <thead>
	  <tr>
		  <th>ジャケ写</th>
		  <th>タイトル</th>
		  <th>アーティスト</th>
		  <th>値段</th>
		  <th>個数</th>
	  </tr>
  </thead>
  <tbody>
		<% @cart_items.each do |item| %>
		  <tr>
			  <td><%= attachment_image_tag item.product, :image, format: 'jpg', fallback: 'no_image.jpg', size: '30x30' %></td>
			  <td><%= item.product.title %></td>
			  <td></td>
			  <td><%= item.product.price.to_i %>円</td>
			  <td><%= item.product_amount %></td> 
		  </tr>
    <% end %>
  </tbody>
</table>

<%= form_with(model: @new_order) do |f| %>
  <%= f.text_field :delivery_postal_code, readonly: true %><br>
  <%= f.text_field :delivery_address, readonly: true  %><br>
  <%= f.text_field :delivery_name_kana, readonly: true  %><br>
  <%= f.text_field :delivery_name, readonly: true  %><br>
  <%= @new_order.postage %><br>
  <%= @new_order.total_price %><br>
  <%= @new_order.consumption_tax %><br>
  <%= f.label :payment_method, "支払い方法" %>
  <%= f.select :payment_method, Order.payment_methods.keys %><br>
  <%= f.submit "購入を確定する" %>
<% end %>
